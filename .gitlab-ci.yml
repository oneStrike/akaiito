image: asherith/node

stages:
  - build
  - docker

variables:
  Admin: 'asherith/admin'
  Client: 'asherith/client'
  Server: 'asherith/server'
  PnpmRegistry: 'https://registry.npmmirror.com'
  LOCKFILE: pnpm-lock.yaml

cache:
  key: cache-${CI_COMMIT_REF_NAME}
  paths:
    - node_modules/

before_script:
  - corepack enable
  - pnpm config set registry https://registry.npmmirror.com

build:
  stage: build
  tags:
    - akaiito
  script:
    - pnpm install --frozen-lockfile
    - pnpm run -r build
#
#docker:
#  stage: docker
#  tags:
#    - akaiito
#  script:
#    - docker login -u $DOCKER_USER -p $DOCKER_PASS
#    - docker build -t $Admin.
#    - docker push $Admin
#    - docker build -t $Client.
#    - docker push $Client
#    - docker build -t $Server.
#    - docker push $Server
