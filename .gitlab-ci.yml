stages:
  - build
  - docker

variables:
  akaiito_admin: 'akaiito-admin'
  akaiito_client: 'akaiito-client'
  akaiito_server: 'akaiito-server'

build:
  stage: build
  tags:
    - akaiito
  script:
    - docker rmi -f $akaiito_server $akaiito_client $akaiito_admin
    - docker build . --target admin --tag $akaiito_admin
    - docker build . --target client --tag $akaiito_client
    - docker build . --target server --tag $akaiito_server
